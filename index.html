<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Open House...</title> <!-- Set by JS -->

    <!-- ★★★ START: SOCIAL SHARE META TAGS - EDIT MANUALLY FOR EACH PAGE ★★★ -->
    <meta property="og:title" content="🌿 Elegant Open House | [Property Address Here] | [Brokerage Name Here]" />
    <meta property="og:description" content="Discover this sophisticated home at [Property Address Here]. Register for your exclusive viewing." />
    <meta property="og:image" content="[ABSOLUTE_URL_TO_REALTOR_PHOTO_HERE_NEUTRAL_THEME]" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="🌿 Elegant Open House | [Property Address Here] | [Brokerage Name Here]" />
    <meta name="twitter:description" content="Discover this sophisticated home at [Property Address Here]. Register for your exclusive viewing." />
    <meta name="twitter:image" content="[ABSOLUTE_URL_TO_REALTOR_PHOTO_HERE_NEUTRAL_THEME]" />
    <!-- ★★★ END: SOCIAL SHARE META TAGS ★★★ -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* --- Root Variables and Base Styles (Elegant Neutral Pastel Theme) --- */
        :root {
            /* ★★★ ELEGANT NEUTRAL PASTEL THEME PALETTE ★★★ */
            --primary-color: #d4c8b0;    /* Sophisticated Beige / Light Khaki */
            --secondary-color: #a3b8a0;  /* Soft, Muted Olive Green */
            --accent-color: #e0d6c1;     /* Light Creamy Beige / Ivory */
            --highlight-gold: #c0a080;   /* Muted Gold/Bronze for highlights */

            --light-bg: #fdfbf7;         /* Very Light Warm Off-White / Alabaster */
            --card-light-bg: #ffffff;    /* Pure White for cards */

            --dark-text-color: #5c564d;  /* Warm Dark Grey/Brown Text (Good Contrast) */
            --medium-text-color: #8a8075; /* Medium Warm Grey/Brown */

            --header-bg: rgba(253, 251, 247, 0.9); /* Light transparent bg */
            --header-bg-scrolled: rgba(253, 251, 247, 0.98);

             /* Light Ethereal Glassmorphism (Neutral Tones) */
             --glass-blur: 18px;
             --glass-bg: rgba(255, 255, 255, 0.78);   /* Slightly more opaque white glass */
             --glass-border: rgba(212, 200, 176, 0.4); /* Softer Beige border */
             --glass-shadow: 0 7px 28px 0 rgba(180, 170, 160, 0.12); /* Very soft, warm shadow */
             --glass-inner-shadow: inset 0 0 12px rgba(212, 200, 176, 0.06);

            --border-radius: 20px;
            --transition-speed: 0.5s;
            --cubic-bezier-elegant: cubic-bezier(0.25, 0.1, 0.25, 1);
            /* Font sizes remain responsive */
            --font-size-base: clamp(0.9rem, 1.5vw + 0.5rem, 1.05rem);
            --font-size-h1: clamp(2rem, 4.5vw + 0.8rem, 3.4rem);
            --font-size-h2: clamp(1.6rem, 3.5vw + 0.7rem, 2.5rem);
            --font-size-h3: clamp(1.25rem, 2.8vw + 0.5rem, 1.7rem);
            --font-size-large: clamp(1.05rem, 1.8vw + 0.45rem, 1.25rem);
            --font-size-medium: clamp(0.9rem, 1.6vw + 0.35rem, 1.1rem);
            --font-size-small: clamp(0.8rem, 1.1vw + 0.35rem, 0.9rem);
            --font-size-input: clamp(1rem, 1.8vw + 0.4rem, 1.05rem); /* Min 16px for iOS zoom */
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: var(--font-size-base); }
        body {
            font-family: 'Poppins', sans-serif; font-weight: 400;
            line-height: 1.75;
            color: var(--dark-text-color); /* Default text for light theme */
            background-color: var(--light-bg);
            background-image: linear-gradient(rgba(253, 251, 247, 0.75), rgba(253, 251, 247, 0.92)),
                              var(--bg-image-url, url('https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1980&q=80'));
            background-attachment: fixed; background-position: center; background-repeat: no-repeat; background-size: cover;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .container { max-width: 1000px; margin: auto; padding: 0 clamp(15px, 4vw, 25px); }
        .section { padding: clamp(50px, 8vh, 90px) 0; opacity: 0; transform: translateY(50px); transition: opacity 1.2s var(--cubic-bezier-elegant), transform 1.2s var(--cubic-bezier-elegant); }
        .section.visible { opacity: 1; transform: translateY(0); }
        .section-title {
            font-family: 'Playfair Display', serif; font-weight: 700;
            font-size: var(--font-size-h2);
            color: var(--primary-color); /* Beige title */
            text-align: center;
            margin-bottom: clamp(35px, 7vh, 60px); position: relative;
            padding-bottom: 15px; letter-spacing: 1px;
        }
        .section-title::after {
            content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: clamp(70px, 12vw, 100px); height: 1.5px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent); /* Beige line */
            opacity: 0.7;
        }
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur)); -webkit-backdrop-filter: blur(var(--glass-blur));
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow), var(--glass-inner-shadow);
            padding: clamp(30px, 5vw, 45px) clamp(30px, 6vw, 55px);
            margin-top: clamp(25px, 4vh, 40px);
            color: var(--dark-text-color); /* Dark text inside glass */
            position: relative; overflow: hidden;
        }

        /* --- Header (Neutral Pastel Theme) --- */
        .main-nav { background: var(--header-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); padding: 16px 0; border-bottom: 1px solid rgba(212, 200, 176, 0.25); z-index: 1000; position:fixed; width:100%; top:0; left:0; transition: background-color 0.4s ease, padding 0.4s ease, top 0.4s ease; }
        .main-nav.scrolled { background: var(--header-bg-scrolled); padding: 12px 0; }
        .main-nav .container { display: flex; justify-content: space-between; align-items: center; }
        .header-left { display: flex; align-items: center; gap: clamp(15px, 3vw, 25px); }
        .main-nav .logo { color: var(--dark-text-color); font-size: clamp(1.3rem, 2.8vw, 1.6rem); font-family: 'Montserrat', sans-serif; font-weight: 600; text-decoration: none;}
        .header-address { color: var(--medium-text-color); border-left: 1px solid rgba(138, 128, 117, 0.2); padding-left: clamp(12px, 2.5vw, 18px); font-size: var(--font-size-small); font-weight: 300; display:none; }
        @media (min-width: 768px) { .header-address { display: block; } }
        .main-nav ul { list-style: none; display: none; padding:0; margin:0; }
        @media (min-width: 992px) {
            .main-nav ul { display: flex; } .main-nav ul li { margin-left: clamp(25px, 4vw, 40px); }
            .main-nav ul li a { color: var(--medium-text-color); text-decoration: none; font-weight: 500; padding: 10px 0; font-size: var(--font-size-small); letter-spacing: 0.6px; position: relative; transition: color var(--transition-speed) var(--cubic-bezier-elegant); }
            .main-nav ul li a::after { content: ''; position: absolute; bottom: -3px; left: 0; width: 0; height: 1.5px; background-color: var(--primary-color); transition: width 0.4s var(--cubic-bezier-elegant); }
            .main-nav ul li a:hover { color: var(--dark-text-color); } .main-nav ul li a:hover::after { width: 100%; }
            .main-nav ul li a.active { color: var(--primary-color); font-weight: 600; } .main-nav ul li a.active::after { width: 100%; }
        }
        @media (max-width: 991px) { .main-nav .container { justify-content: center; } .header-left { gap: 15px; } }
        @media (max-width: 600px) { .header-address { display: none;} .main-nav .logo { font-size: clamp(1.3rem, 5vw, 1.5rem); } .main-nav { padding: 15px 0; } .main-nav.scrolled { padding: 12px 0; } }


        /* --- Hero Section (Neutral Pastel Theme) --- */
        #hero { color: var(--dark-text-color); text-shadow: 0px 1px 3px rgba(255,255,255,0.7); padding: 100px 15px 60px; min-height: 100vh; min-height: 100svh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; position: relative; overflow: hidden;}
        #hero > * { position: relative; }
        #hero .hero-title-line { font-size: var(--font-size-h1); color: var(--dark-text-color); font-family: 'Playfair Display', serif; font-weight: 700; margin-bottom: clamp(15px, 4vh, 30px); line-height: 1.2; display: inline-block; min-height: 1.2em;}
        #hero .hero-title-line .highlight { color: var(--primary-color); } /* Beige highlight */
        #hero .hero-title-line:not(.typing-done)::after { background-color: var(--primary-color); content: ''; display: inline-block; width: 3px; height: 0.9em; margin-left: 8px; vertical-align: baseline; opacity: 1; animation: blink 0.8s step-end infinite; }
        #hero .hero-title-line.typing-done::after { display: none; }
        #hero p.subtitle { font-size: var(--font-size-large); color: var(--medium-text-color); font-weight: 300; margin-bottom: clamp(35px, 6vh, 55px); max-width: 850px; line-height: 1.9; opacity: 0.01; transform: translateY(15px) scale(0.98); transition: opacity 1s ease-out 0.2s, transform 1s ease-out 0.2s; }
        .cta-button {
            font-size: var(--font-size-medium); padding: clamp(16px, 2.5vw, 20px) clamp(35px, 6vw, 50px);
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); /* Beige to Cream gradient */
            color: var(--dark-text-color); /* Dark text on light button for contrast */
            font-weight: 500; letter-spacing: 0.8px; text-decoration: none; border-radius: 50px;
            box-shadow: 0 5px 25px rgba(212, 200, 176, 0.3);
            display: inline-block; position: relative; overflow: hidden; opacity: 0.01; transform: translateY(15px) scale(0.98);
            transition: opacity 1s ease-out 0.4s, transform 1s ease-out 0.4s, background 0.4s var(--cubic-bezier-elegant), box-shadow 0.4s var(--cubic-bezier-elegant);
        }
        #hero.typing-complete p.subtitle { transition-delay: 0.3s; opacity: 1; transform: translateY(0) scale(1); }
        #hero.typing-complete .cta-button { transition-delay: 0.5s; opacity: 1; transform: translateY(0) scale(1); }
        .cta-button::before { content: ''; position: absolute; top: 0; left: -110%; width: 60%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); transform: skewX(-25deg); transition: left 0.8s ease; }
        .cta-button:hover::before { left: 130%; }
        .cta-button:hover { background: linear-gradient(135deg, var(--accent-color), var(--primary-color)); box-shadow: 0 8px 35px rgba(212, 200, 176, 0.4); transform: scale(1.05) translateY(-4px); }
        .cta-button i { margin-left: 12px; }
        @keyframes blink { 50% { opacity: 0; } }

        /* --- What's Included (Neutral Pastel Theme) --- */
        #whats-included ul { list-style: none; padding: 0; margin: 20px auto; max-width: 750px; }
        #whats-included li { background: rgba(255,255,255,0.6); border: 1px solid rgba(212, 200, 176, 0.25); box-shadow: 0 3px 10px rgba(180,170,160,0.08); margin-bottom: 22px; padding: clamp(16px, 2.5vw, 22px) clamp(18px, 3.5vw, 28px); border-radius: 14px; display: flex; align-items: center; transition: transform 0.5s var(--cubic-bezier-elegant), background-color 0.5s var(--cubic-bezier-elegant), box-shadow 0.5s var(--cubic-bezier-elegant); }
        #whats-included li:hover { background-color: rgba(212, 200, 176, 0.12); box-shadow: 0 5px 18px rgba(180,170,160,0.15); transform: scale(1.03) translateX(8px); }
        #whats-included li i { color: var(--secondary-color); /* Soft Olive icon */ font-size: clamp(1.6rem, 3vw, 2rem); margin-right: clamp(20px, 4vw, 30px); width: 40px; text-align: center; transition: transform 0.5s var(--cubic-bezier-elegant); }
        #whats-included li:hover i { transform: scale(1.15) rotate(4deg); }
        #whats-included li span { font-size: var(--font-size-medium); color: var(--dark-text-color); font-weight: 400; }

        /* --- About Realtor (Neutral Pastel Theme) --- */
        #about-realtor .realtor-content { display: flex; flex-direction: column; align-items: center; gap: 30px; text-align: center;}
        @media (min-width: 768px) { #about-realtor .realtor-content { flex-direction: row; text-align: left; gap: clamp(40px, 6vw, 60px); } }
        #about-realtor .realtor-image-container { flex-shrink: 0; width: clamp(150px, 30vw, 200px); height: clamp(150px, 30vw, 200px); position: relative; border-radius: 50%; box-shadow: 0 0 35px rgba(212, 200, 176, 0.3); margin-bottom: 15px; }
        @media (min-width: 768px) { #about-realtor .realtor-image-container { margin-bottom: 0; } }
        #about-realtor .realtor-image-container img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; border: clamp(4px, 0.8vw, 6px) solid var(--primary-color); display: block; }
        #about-realtor .realtor-bio { flex-grow: 1; }
        #about-realtor .realtor-bio h3 { font-family: 'Montserrat', sans-serif; font-size: var(--font-size-h3); color: var(--primary-color); margin-bottom: 18px; font-weight: 600; }
        #about-realtor .realtor-bio p { font-size: var(--font-size-small); line-height: 1.9; color: var(--medium-text-color); font-weight: 300; }

        /* --- Sign In Form (Neutral Pastel Theme) --- */
        #signin p.subtitle { color: var(--medium-text-color); font-size: var(--font-size-medium); font-weight: 300; text-align: center; margin-top: calc(-1 * clamp(25px, 5vh, 40px)); margin-bottom: clamp(35px, 6vh, 50px); }
        #signin .form-grid { display: grid; grid-template-columns: 1fr; gap: clamp(25px, 4vh, 35px); margin-top: 35px; max-width: 600px; margin-left: auto; margin-right: auto; }
        .form-group label { color: var(--medium-text-color); font-size: var(--font-size-small); font-weight: 500; display: block; margin-bottom: 12px; letter-spacing: 0.7px; }
        .form-group input[type="text"], .form-group input[type="email"], .form-group input[type="tel"] {
            width: 100%; padding: clamp(15px, 2.2vw, 18px) 25px; padding-left: clamp(50px, 8vw, 60px);
            border: 1px solid rgba(180, 170, 160, 0.35);
            border-radius: 14px; font-size: var(--font-size-input); font-family: 'Poppins', sans-serif;
            background-color: rgba(255, 255, 255, 0.9);
            color: var(--dark-text-color); transition: all 0.4s var(--cubic-bezier-elegant); min-height: 50px;
        }
        .form-group input::placeholder { color: #a89f95; opacity: 0.8; }
        .form-group input:focus { outline: none; border-color: var(--primary-color); background-color: #fff; box-shadow: 0 0 12px rgba(212, 200, 176, 0.25); }
        .input-wrapper { position: relative; }
        .input-wrapper i { position: absolute; left: clamp(18px, 3vw, 22px); top: 50%; transform: translateY(-50%); color: #b0a89e; font-size: clamp(1rem, 2vw, 1.15rem); transition: color 0.4s var(--cubic-bezier-elegant); pointer-events: none; }
        .input-wrapper input:focus + i { color: var(--primary-color); }
        .submit-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: var(--dark-text-color);
            border: none; padding: clamp(16px, 2.5vw, 18px) 40px; font-size: var(--font-size-medium); font-weight: 600;
            border-radius: 50px; cursor: pointer; transition: all var(--transition-speed) var(--cubic-bezier-elegant);
            width: 100%; margin-top: 20px; letter-spacing: 1px; box-shadow: 0 6px 25px rgba(212, 200, 176, 0.3);
            display: flex; align-items: center; justify-content: center; gap: 15px; position: relative; overflow: hidden; min-height: 55px;
        }
        .submit-btn:hover { background: linear-gradient(135deg, var(--accent-color), var(--primary-color)); box-shadow: 0 10px 35px rgba(212, 200, 176, 0.4); transform: translateY(-5px) scale(1.03); }
        .submit-btn:active { transform: translateY(-2px) scale(1.01); box-shadow: 0 7px 30px rgba(212, 200, 176, 0.25); }
        .submit-btn i { font-size: clamp(1.1rem, 2vw, 1.25rem); }
        .submit-btn.loading { background: #e8e4da; color: #8a8075; }
        .submit-btn .button-text { transition: opacity 0.3s ease; }
        .submit-btn.loading .button-text { opacity: 0; }
        .submit-btn .spinner { display: inline-block; position: absolute; width: 20px; height: 20px; border: 3px solid rgba(100, 100, 100, 0.2); border-radius: 50%; border-top-color: var(--dark-text-color); animation: spin 1s ease-in-out infinite; opacity: 0; transition: opacity 0.3s ease; }
        .submit-btn.loading .spinner { opacity: 1; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- Modal Styles (Neutral Pastel Theme) --- */
        .modal-overlay { background-color: rgba(253, 251, 247, 0.75); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; z-index: 1050; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0s linear 0.4s; }
        .modal-overlay.visible { opacity: 1; visibility: visible; transition-delay: 0s; }
        .modal-content { background: #fff; box-shadow: 0 10px 40px rgba(180,170,160,0.15), 0 0 0 1px rgba(0,0,0,0.03); color: var(--dark-text-color); padding: clamp(30px, 5vw, 40px); border-radius: var(--border-radius); text-align: center; max-width: 550px; width: 90%; position: relative; transform: translateY(0); opacity: 1; transition: none; }
        .modal-step { display: none; opacity: 1; }
        .modal-step.active { display: block !important; opacity: 1 !important; animation: fadeInStep 0.4s ease-out forwards; }
        @keyframes fadeInStep { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .modal-step .question-text { color: var(--dark-text-color); font-size: var(--font-size-large); font-weight: 500; margin-bottom: 35px; line-height: 1.6; }
        .modal-options { display: flex; flex-direction: column; gap: 15px; align-items: center; }
        .modal-option-btn { color: var(--dark-text-color); background-color: rgba(0,0,0,0.02); border: 1px solid rgba(0,0,0,0.06); display: block; width: 100%; max-width: 380px; padding: 15px 25px; font-size: var(--font-size-medium); font-weight: 500; border-radius: 12px; cursor: pointer; text-align: center; transition: background-color 0.3s ease, transform 0.2s ease, border-color 0.3s ease; }
        .modal-option-btn:hover { background-color: rgba(212, 200, 176, 0.1); border-color: rgba(212, 200, 176, 0.3); transform: translateY(-2px); }
        .modal-option-btn:active { background-color: rgba(212, 200, 176, 0.15); }
        #modal-step-final i.icon { color: var(--primary-color); text-shadow: 0 0 15px rgba(212, 200, 176, 0.3); font-size: clamp(4rem, 10vw, 5rem); margin-bottom: 25px; display: inline-block; animation: popIn 0.6s var(--cubic-bezier-elegant) 0.3s backwards; }
        @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 80% { transform: scale(1.05); } 100% { transform: scale(1); opacity: 1;} }
        #modal-step-final h2 { color: var(--primary-color); font-family: 'Playfair Display', serif; font-size: var(--font-size-h3); margin-bottom: 15px; font-weight: 700; }
        #modal-step-final p#modalMainMessage { color: var(--medium-text-color); font-size: var(--font-size-medium); margin-bottom: 30px; line-height: 1.8; font-weight: 300;}
        #modal-step-final p#modalHost { color: var(--medium-text-color); font-size: var(--font-size-small); }
        #modal-step-final strong { color: var(--dark-text-color); }
        .modal-close-btn { color: var(--medium-text-color); position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.8rem; cursor: pointer; padding: 5px; line-height: 1; transition: color 0.3s ease, transform 0.3s ease; z-index: 2; }
        .modal-close-btn:hover { color: var(--dark-text-color); transform: rotate(90deg); }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1060; pointer-events: none; }
        @keyframes bounce { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-15px) scale(1.03); } }

        /* --- Footer (Neutral Pastel Theme - CORRECTED) --- */
        footer {
            background-color: #f5f2ed; /* Light warm beige/cream */
            color: var(--medium-text-color);
            text-align: center;
            padding: clamp(40px, 7vh, 70px) clamp(15px, 4vw, 25px) clamp(25px, 4vh, 40px);
            margin-top: clamp(60px, 10vh, 100px);
            border-top: 1px solid rgba(212, 200, 176, 0.25); /* Softer beige border */
        }
        footer .footer-content { max-width: 850px; margin: auto; }
        footer .brokerage-logo img { max-height: clamp(45px, 8vw, 60px); margin-bottom: 30px; /* Optional: filter: sepia(20%) brightness(95%); */ }
        footer h4 { font-family: 'Montserrat', sans-serif; font-size: var(--font-size-large); font-weight: 500; margin-bottom: 25px; color: var(--primary-color); letter-spacing: 1px; }
        footer p { margin-bottom: 15px; font-size: var(--font-size-small); line-height: 1.8; font-weight: 300;}
        footer strong { color: var(--dark-text-color); font-weight: 500; }
        footer a { color: var(--primary-color); text-decoration: none; transition: color 0.4s ease; }
        footer a:hover { color: var(--highlight-gold); /* Muted gold for hover */ }
        footer p i { margin-right: 8px; opacity: 0.7; color: var(--medium-text-color); }
        footer p i.fa-envelope { margin-left: 15px; }
        footer .social-icons { margin: clamp(25px, 5vh, 40px) 0; }
        footer .social-icons a { color: var(--medium-text-color); font-size: clamp(1.4rem, 3vw, 1.7rem); margin: 0 clamp(12px, 2.5vw, 18px); transition: color 0.4s var(--cubic-bezier-elegant), transform 0.4s var(--cubic-bezier-elegant); }
        footer .social-icons a:hover { color: var(--primary-color); transform: scale(1.2) rotate(-5deg); }
        footer .copyright { margin-top: clamp(30px, 6vh, 50px); font-size: clamp(0.75rem, 1.5vw + 0.3rem, 0.9rem); opacity: 0.7; font-weight: 300;} /* Increased opacity */
        footer .copyright a { color: var(--primary-color); opacity: 0.9; }
        footer .copyright a:hover { color: var(--highlight-gold); opacity: 1; }

    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas>
    <nav class="main-nav" id="mainNav">
        <div class="container">
             <div class="header-left">
                <a href="#" class="logo" id="navBrandLogo"></a>
                <span class="header-address" id="navAddress"></span>
             </div>
             <ul id="navLinksList">
                <li><a href="#hero" class="active">Welcome</a></li>
                <li><a href="#whats-included">Compendium</a></li>
                <li><a href="#about-realtor">Your Host</a></li>
                <li><a href="#signin">Register</a></li>
             </ul>
        </div>
    </nav>

    <section id="hero" class="section visible">
        <div class="hero-title-line" id="heroTitle"></div>
        <p class="subtitle" id="heroSubtitle"></p>
        <a href="#signin" class="cta-button" id="heroCta">Register & Receive Compendium <i class="fas fa-chevron-right"></i></a>
    </section>

    <main>
        <section id="whats-included" class="section"> <div class="container"> <div class="glass-card"> <h2 class="section-title">The Property Compendium</h2> <ul id="bundleList"></ul> </div> </div> </section>
        <section id="about-realtor" class="section"> <div class="container"> <div class="glass-card"> <h2 class="section-title">Your Dedicated Host</h2> <div class="realtor-content"> <div class="realtor-image-container"> <img src="" alt="Realtor Photo" id="realtorPhoto"> </div> <div class="realtor-bio"> <h3 id="realtorNameBio"></h3> <p id="realtorBioText"></p> </div> </div> </div> </div> </section>
        <section id="signin" class="section"> <div class="container"> <div class="glass-card" id="signInCard"> <h2 class="section-title">Register Your Interest</h2> <p class="subtitle">Kindly provide your details...</p> <form id="signInForm"> <div class="form-grid"> <div class="form-group"><label for="fullName">Full Name:</label><div class="input-wrapper"><input type="text" id="fullName" name="fullName" placeholder="Example Full Name" required><i class="fas fa-user-alt"></i></div></div> <div class="form-group"><label for="email">Email Address:</label><div class="input-wrapper"><input type="email" id="email" name="email" placeholder="Example Email" required><i class="fas fa-envelope"></i></div></div> <div class="form-group"><label for="phone">Phone Number (Preferred):</label><div class="input-wrapper"><input type="tel" id="phone" name="phone" placeholder="Example Phone" inputmode="numeric"><i class="fas fa-phone"></i></div></div> <div class="form-group"><button type="submit" class="submit-btn"><span class="button-text">Request My Compendium</span><div class="spinner"></div></button></div> </div> </form> </div> </div> </section>
    </main>

    <footer> <!-- Footer HTML Structure -->
        <div class="container footer-content">
             <div class="brokerage-logo"> <img src="" alt="Brokerage Logo" id="footerBrokerageLogo"> </div>
            <h4 id="footerBrokerageName"></h4>
            <p><strong id="footerRealtorName"></strong> | <span id="footerRealtorTitle"></span> | DRE #<span id="footerRealtorDre"></span></p>
            <p><i class="fas fa-mobile-alt"></i> <a href="" id="footerRealtorPhoneLink"><span id="footerRealtorPhone"></span></a> | <i class="fas fa-envelope"></i> <a href="" id="footerRealtorEmailLink"><span id="footerRealtorEmail"></span></a></p>
            <p><i class="fas fa-map-marker-alt"></i> <span id="footerBrokerageAddress"></span></p>
             <div class="social-icons" id="footerSocialIcons"></div>
            <p class="copyright" id="footerCopyright"></p>
        </div>
    </footer>

    <div class="modal-overlay" id="successModalOverlay">
        <div class="modal-content" id="successModalContent" role="dialog" aria-modal="true" aria-labelledby="modalStepTitle">
            <button class="modal-close-btn" id="modalCloseBtn" aria-label="Close"><i class="fas fa-times" aria-hidden="true"></i></button>
            <div id="modal-steps-container"><!-- Dynamic Step Content Goes Here --></div>
             <div class="modal-step" id="modal-step-final" style="display: none;">
                 <i class="fas fa-leaf icon"></i>
                 <h2 id="modalHeader">Thank You!</h2>
                 <p id="modalMainMessage">Your information for the <strong id="modalAddress"></strong> Open House Compendium has been sent. <br><br><span id="modalEmailPrompt">You'll receive an email from our team shortly...</span></p>
                 <p id="modalHost">Your Host: <strong id="modalRealtorName"></strong></p>
             </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
         // ========================================================================
         // ★★★ CONFIGURATION AREA START ★★★
         // ========================================================================
        const config = {
  property: {
    streetAddress: "182 McCaul St",
    city: "Toronto",
    cityStateZip: "Toronto, ON M5T 1W5",
    heroSubtitle: "Approx. 1800 sq ft across three levels + massive rooftop terrace with CN Tower views, generous bedrooms & direct garage access. Register to view the bespoke Property Compendium...",
    backgroundImageUrl: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=1700&q=80",
    listingUrl: "https://www.realtor.ca/real-estate/28224669/182-mccaul-street-toronto-kensington-chinatown-kensington-chinatown",
    galleryUrl: "https://jhfilms.pixieset.com/182mccaulstreet/",
    floorPlanUrl: null,
    compsUrl: "https://app.realmmlp.ca/shared/portal/Z69zLNLeQJimW1JDnPZR/ONGb9yWAeAtplogNPnDAFGbOkL7oPDiplwyP2wrPf7koPy4l4zH9wbJjM88VI8k8pKGMBnCB8Lny7o12Hq4JrXkBNOF3BJV9MGYwuqgl9QpNLOtAbkywyQbRIYejmz1DVzUAnXD82jrmfrml4jbQOXHKoOR8GoBZUj5NqPZw8rfl3yVqOk3mF8V?q=treb%2FlistingID%3AC11984774%2CC12072110%2CC12062863",
    virtualTourUrl: null,
    highlights: [
      "Approx. 1800 sq ft of interior space across three levels with generous bedrooms and storage.",
      "Massive rooftop terrace with CN Tower views, built-in water access, and custom pergola.",
      "Private front door entry with direct-access garage — no elevators, no lobbies."
    ],
    keyFeature: "The rooftop terrace with CN Tower views, especially combined with the built-in water access and custom pergola.",
    neighbourhood: "Central downtown location — minutes to U of T, OCAD, hospitals (University Health Network), AGO, and Queen West.\n\nWalkable and connected — Baldwin Village’s restaurants, Kensington Market’s energy, and Chinatown’s food scene are all right there.\n\nCultural and academic hub — museums, galleries, libraries, and world-class education within walking distance.\n\nCharacter-rich — the area blends historic homes, low-rise walk-ups, and vibrant streets — it’s not a cold glass tower zone.\n\nTop transit access — TTC streetcars, St. George/Queen’s Park subway stations nearby, bike lanes everywhere.\n\nQuiet pockets tucked between major arteries — you can live peacefully while being 5 minutes from everything.",
    price: "$1,800,000",
    beds: 3,
    baths: 2,
    homeType: "POTL",
    openHouseDate: "2025-05-03"
  },
  realtor: {
    fullName: "Daaron Johnston",
    firstName: "Daaron",
    title: "Sales Representative",
    phone: "(647) 409-6568",
    email: "daaron@property.ca",
    dreNumber: null,
    bio: "Helping you discover the best of Toronto living — specialized in unique freehold and downtown properties.",
    photoUrl: "https://drive.google.com/uc?id=1cSdZqjmAJzj-KeaORO0EgMGUwHQbv2Nq",
    social: {
      linkedin: null,
      instagram: null,
      website: null
    }
  },
  brokerage: {
    name: "Property.ca Realty Inc.",
    logoUrl: "https://property.ca/build/images/pc-w-logo.96449591.svg",
    address: "103-350 Dundas St West, Toronto, ON M5T 1G5"
  },
  openHouse: {
    bundleItems: [
      { icon: "fas fa-ruler-combined", text: "Architectural Floor Plans (if available)" },
      { icon: "fas fa-star", text: "Detailed Finishes & Features List" },
      { icon: "fas fa-camera-retro", text: "Full-Resolution Photo Gallery" },
      { icon: "fas fa-film", text: "Property Video Tour (if available)" },
      { icon: "fas fa-map-location-dot", text: "Neighbourhood Guide & Recent Sales Stats" },
      { icon: "fas fa-file-invoice-dollar", text: "Condo/POTL Information & Financials" },
      { icon: "fas fa-key", text: "Early Access Notifications for Similar Toronto Listings" }
    ]
  },
  meta: {
    pageTitlePrefix: "🏠 182 McCaul St Open House",
    navBrandLogoText: "Property.ca",
    privacyPolicyLink: "https://property.ca/privacy",
    termsLink: "#terms"
  },
  settings: {
    webhookUrl: "https://n8n.salesgenius.co/webhook/openhouse",
    confettiColors: ['#009688', '#ffeb3b', '#fafafa', '#ffc107', '#1b6ca8']
  },
  modalQuestions: [
    {
      id: "agent_status",
      questionText: "Are you currently exploring homes with a real estate agent?",
      options: [
        { value: "committed", text: "Yes, I'm committed to an agent." },
        { value: "not_committed", text: "No, I'm not committed to an agent." },
        { value: "gathering_info", text: "Just gathering information at this stage." }
      ]
    }
  ]
};

         // ========================================================================
         // ★★★ CONFIGURATION AREA END ★★★
         // ========================================================================

        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM References & State (Unchanged) ---
            const mainNav = document.getElementById('mainNav');
            const heroSection = document.getElementById('hero');
            const heroTitleElement = document.getElementById('heroTitle');
            const heroSubtitle = document.getElementById('heroSubtitle');
            const signInForm = document.getElementById('signInForm');
            const successModalOverlay = document.getElementById('successModalOverlay');
            const successModalContent = document.getElementById('successModalContent');
            const modalStepsContainer = document.getElementById('modal-steps-container');
            const modalStepFinal = document.getElementById('modal-step-final');
            const modalCloseBtn = document.getElementById('modalCloseBtn');
            const confettiCanvas = document.getElementById('confetti-canvas');
            const myConfetti = (typeof confetti === 'function' && confettiCanvas) ? confetti.create(confettiCanvas, { resize: true, useWorker: true }) : null;
            const submitButton = signInForm?.querySelector('.submit-btn');
            const buttonTextSpan = submitButton?.querySelector('.button-text');
            let currentStepIndex = 0;
            let collectedAnswers = {};
            let initialFormData = {};

            // --- Helper functions (Unchanged) ---
            function setTextContent(id, text) { const el=document.getElementById(id); if(el) el.textContent=text||''; else console.warn(`ID '${id}' not found.`); }
            function setHTMLContent(id, html) { const el=document.getElementById(id); if(el) el.innerHTML=html||''; else console.warn(`ID '${id}' not found.`); }
            function setImage(id, src, alt) { const el=document.getElementById(id); if(el && el.tagName==='IMG'){ el.src=src||''; el.alt=alt||'Image'; } else console.warn(`ID '${id}' not IMG or not found.`); }
            function setLinkHref(id, href) { const el=document.getElementById(id); if(el && el.tagName==='A'){ el.href=href||'#'; } else console.warn(`ID '${id}' not A or not found.`); }
            function populateSocialIcons(containerId, socialLinks) { const container = document.getElementById(containerId); if (!container) { console.warn(`Social container '${containerId}' not found.`); return; } container.innerHTML = ''; const platformIcons = { linkedin: 'fab fa-linkedin-in', instagram: 'fab fa-instagram', website: 'fas fa-globe', facebook: 'fab fa-facebook-f', twitter: 'fab fa-twitter', pinterest: 'fab fa-pinterest-p'}; for (const platform in socialLinks) { const url = socialLinks[platform]; if (url && url !== "#" && url !== "") { const iconClass = platformIcons[platform]; if (iconClass) { const link = document.createElement('a'); link.href = url; link.target = "_blank"; link.rel = "noopener noreferrer"; link.setAttribute('aria-label', platform.charAt(0).toUpperCase() + platform.slice(1)); link.innerHTML = `<i class="${iconClass}" aria-hidden="true"></i>`; container.appendChild(link); } } } }

            // --- Apply Initial Config Data ---
            function populateInitialData() {
                try {
                    if (config.property.backgroundImageUrl && config.property.backgroundImageUrl.startsWith('http')) { document.body.style.setProperty('--bg-image-url', `url('${config.property.backgroundImageUrl}')`); }
                    document.title = `${config.meta.pageTitlePrefix} | ${config.property.streetAddress} | ${config.brokerage.name}`;
                    setTextContent('navBrandLogo', config.meta.navBrandLogoText || config.brokerage.name);
                    setTextContent('navAddress', config.property.streetAddress);
                    setTextContent('heroSubtitle', config.property.heroSubtitle);
                    const bundleList = document.getElementById('bundleList');
                    if (bundleList) { bundleList.innerHTML = ''; config.openHouse.bundleItems.forEach(item => { const li = document.createElement('li'); li.innerHTML = `<i class="${item.icon}" aria-hidden="true"></i> <span>${item.text}</span>`; bundleList.appendChild(li); }); } else { console.warn("Bundle list element not found."); }
                    setImage('realtorPhoto', config.realtor.photoUrl, config.realtor.fullName);
                    setTextContent('realtorNameBio', config.realtor.fullName);
                    setHTMLContent('realtorBioText', config.realtor.bio);
                    setTextContent('modalAddress', `${config.property.streetAddress}, ${config.property.city}`);
                    setTextContent('modalRealtorName', config.realtor.fullName);
                    setImage('footerBrokerageLogo', config.brokerage.logoUrl, config.brokerage.name);
                    setTextContent('footerBrokerageName', `${config.brokerage.name}`);
                    setTextContent('footerRealtorName', config.realtor.fullName);
                    setTextContent('footerRealtorTitle', config.realtor.title);
                    setTextContent('footerRealtorDre', config.realtor.dreNumber);
                    setTextContent('footerRealtorPhone', config.realtor.phone);
                    setLinkHref('footerRealtorPhoneLink', `tel:${config.realtor.phone.replace(/\D/g,'')}`);
                    setTextContent('footerRealtorEmail', config.realtor.email);
                    setLinkHref('footerRealtorEmailLink', `mailto:${config.realtor.email}`);
                    setTextContent('footerBrokerageAddress', config.brokerage.address);
                    const currentYear = new Date().getFullYear();
                    setHTMLContent('footerCopyright', `© ${currentYear} ${config.brokerage.name}. All Rights Reserved. | <a href="${config.meta.privacyPolicyLink || '#'}">Privacy Policy</a> | <a href="${config.meta.termsLink || '#'}">Terms of Use</a>`);
                    populateSocialIcons('footerSocialIcons', config.realtor.social);
                } catch (error) { console.error("Error populating data:", error); }
            }
            populateInitialData();

             // --- General Page Logic ---
             let lastScrollTop = 0; const handleScroll = () => { let scrollTop = window.pageYOffset || document.documentElement.scrollTop; if (mainNav) { if (scrollTop > 50) { mainNav.classList.add('scrolled'); } else { mainNav.classList.remove('scrolled'); } } setActiveLink(); }; window.addEventListener('scroll', handleScroll, { passive: true });
             const handleHeroParallax = () => { const scrollY = window.pageYOffset; const parallaxFactor = 0.1; if (heroSection) { const title = heroSection.querySelector('#heroTitle'); const subtitle = heroSection.querySelector('#heroSubtitle'); const cta = heroSection.querySelector('#heroCta'); if(title) title.style.transform = `translateY(${scrollY * parallaxFactor * 0.5}px)`; if(subtitle) subtitle.style.transform = `translateY(${scrollY * parallaxFactor}px)`; if(cta) cta.style.transform = `translateY(${scrollY * parallaxFactor * 1.1}px)`; } }; if (window.innerWidth > 992) { window.addEventListener('scroll', handleHeroParallax, { passive: true }); }
             const navLinks = document.querySelectorAll('#navLinksList li a'); const sectionsForNav = document.querySelectorAll('section[id]'); const setActiveLink = () => { let currentSectionId = 'hero'; const navHeight = mainNav ? mainNav.offsetHeight : 70; const scrollPosition = window.pageYOffset; sectionsForNav.forEach(section => { const sectionTop = section.offsetTop - navHeight - window.innerHeight * 0.3; const sectionBottom = sectionTop + section.offsetHeight; if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) { currentSectionId = section.getAttribute('id'); } }); const nearBottom = (window.innerHeight + scrollPosition) >= document.body.offsetHeight - 200; if (nearBottom && document.getElementById('signin')) { currentSectionId = 'signin'; } if (navLinks) { navLinks.forEach(link => { link.classList.remove('active'); const linkHref = link.getAttribute('href'); if (linkHref === `#${currentSectionId}`) { link.classList.add('active'); } }); } }; setActiveLink();
             const titleHTML = `Welcome to <span class="highlight">${config.property.streetAddress}'s</span> Open House`; let titleCharIndex = 0; function typeWriter() { if (!heroTitleElement) return; if (titleCharIndex < titleHTML.length) { let currentHTML = heroTitleElement.innerHTML; if (titleHTML.charAt(titleCharIndex) === '<') { const tagEndIndex = titleHTML.indexOf('>', titleCharIndex); if (tagEndIndex !== -1) { currentHTML += titleHTML.substring(titleCharIndex, tagEndIndex + 1); heroTitleElement.innerHTML = currentHTML; titleCharIndex = tagEndIndex + 1; } else { currentHTML += titleHTML.charAt(titleCharIndex); heroTitleElement.innerHTML = currentHTML; titleCharIndex++; } } else { currentHTML += titleHTML.charAt(titleCharIndex); heroTitleElement.innerHTML = currentHTML; titleCharIndex++; } const speed = titleHTML.charAt(titleCharIndex - 1) === '>' ? 5 : 45 + Math.random() * 35; setTimeout(typeWriter, speed); } else { heroTitleElement.classList.add('typing-done'); heroSection.classList.add('typing-complete'); } } if(heroTitleElement) setTimeout(typeWriter, 500);
             const sections = document.querySelectorAll('.section:not(#hero)'); const observerOptions = { root: null, threshold: 0.15, rootMargin: "0px 0px -10% 0px" }; const observer = new IntersectionObserver((entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); /* observer.unobserve(entry.target); */ } }); }, observerOptions); sections.forEach(section => { observer.observe(section); });

            // --- Confetti Function ---
             function fireCoolConfetti() { if (!myConfetti) { console.warn("Confetti library not loaded."); return; } const defaults = { startVelocity: 30, spread: 360, ticks: 70, zIndex: 1060, particleCount: 100, }; const colors = config.settings.confettiColors || ['#d4c8b0', '#fdfbf7', '#a3b8a0']; myConfetti({ ...defaults, particleCount: 70, angle: 60, spread: 65, origin: { x: 0.15, y: 0.7 }, colors: colors, scalar: 1 }); myConfetti({ ...defaults, particleCount: 70, angle: 120, spread: 65, origin: { x: 0.85, y: 0.7 }, colors: colors, scalar: 1 }); myConfetti({ ...defaults, particleCount: 120, spread: 90, origin: { y: 0.55 }, colors: colors, scalar: 1.1 }); myConfetti({ ...defaults, particleCount: 25, shapes: ['circle'], colors: ['#e0d6c1', '#c0a080'], scalar: 0.6, origin: { y: 0.65 } }); }


            // --- Modal Step Display & Handling ---
            function displayModalStep(stepIndex) {
                console.log(`Displaying step index: ${stepIndex}`);
                if (!successModalContent || !modalStepsContainer || !modalStepFinal) { console.error("Modal structure elements missing!"); if (submitButton) { submitButton.disabled = false; submitButton.classList.remove('loading'); } return; }
                if (!successModalOverlay) { console.error("Modal overlay missing!"); return; }

                if (!successModalOverlay.classList.contains('visible')) { console.warn("Overlay wasn't visible. Making visible first."); successModalOverlay.classList.add('visible'); setTimeout(() => proceedWithStepDisplay(stepIndex), 50); return; }
                else { proceedWithStepDisplay(stepIndex); }
            }

             function proceedWithStepDisplay(stepIndex) {
                 console.log(`Proceeding to display step: ${stepIndex}`);
                 modalStepsContainer.innerHTML = '';
                 modalStepFinal.style.display = 'none'; modalStepFinal.classList.remove('active');

                 try {
                    if (stepIndex >= 0 && stepIndex < config.modalQuestions.length) {
                        const questionData = config.modalQuestions[stepIndex];
                        console.log("Creating question step:", questionData.id);
                        const stepDiv = document.createElement('div');
                        stepDiv.classList.add('modal-step'); stepDiv.id = `modal-step-${questionData.id}`;
                        stepDiv.innerHTML = `<p class="question-text" id="modalStepTitle-${questionData.id}">${questionData.questionText}</p><div class="modal-options">${questionData.options.map(option => `<button type="button" class="modal-option-btn" data-step="${stepIndex}" data-question-id="${questionData.id}" data-answer="${option.value}">${option.text}</button>`).join('')}</div>`;
                        stepDiv.querySelectorAll('.modal-option-btn').forEach(button => button.addEventListener('click', handleAnswerClick));
                        modalStepsContainer.appendChild(stepDiv);
                        setTimeout(() => { stepDiv.classList.add('active'); }, 10);
                    } else {
                        console.log("Showing final step");
                        setTextContent('modalAddress', `${config.property.streetAddress}, ${config.property.city}`);
                        setTextContent('modalRealtorName', config.realtor.fullName);
                        modalStepFinal.style.display = 'block';
                        setTimeout(() => { modalStepFinal.classList.add('active'); }, 10);
                        fireCoolConfetti();
                    }
                 } catch(error) { console.error(`Error displaying modal step ${stepIndex}:`, error); hideSuccessModal(); }
             }

            function handleAnswerClick(event) {
                 console.log("Answer click handled");
                 try {
                     const button = event.currentTarget;
                     const stepIndex = parseInt(button.dataset.step, 10);
                     const questionId = button.dataset.questionId;
                     const answerValue = button.dataset.answer;
                     if (isNaN(stepIndex)) { console.error("Invalid step index"); return; }
                     collectedAnswers[questionId] = answerValue;
                     console.log('Collected Answers:', collectedAnswers);
                     const currentStep = document.getElementById(`modal-step-${questionId}`);
                     if (currentStep) {
                         currentStep.querySelectorAll('button').forEach(btn => btn.disabled = true);
                         button.style.borderColor = 'var(--primary-color)'; button.style.backgroundColor = 'rgba(212, 200, 176, 0.15)'; // Neutral pastel selected state
                         const activeStep = modalStepsContainer.querySelector('.modal-step.active');
                         if (activeStep) { activeStep.style.transition = 'opacity 0.3s ease-out'; activeStep.style.opacity = '0'; setTimeout(() => displayModalStep(stepIndex + 1), 300); }
                         else { setTimeout(() => displayModalStep(stepIndex + 1), 300); }
                     } else { console.warn(`Could not find step ${questionId} to disable buttons.`); setTimeout(() => displayModalStep(stepIndex + 1), 300); }
                 } catch (error) { console.error("Error handling answer click:", error); hideSuccessModal(); }
             }

            // --- Modal Control Functions ---
             function showQuestionnaireModal() {
                 console.log("showQuestionnaireModal called");
                 if (!successModalOverlay) { console.error("Modal overlay element not found!"); if (submitButton) { submitButton.disabled = false; submitButton.classList.remove('loading'); } return; }
                 currentStepIndex = 0; collectedAnswers = {};
                 if(modalStepsContainer) modalStepsContainer.innerHTML = '';
                 if(modalStepFinal) modalStepFinal.style.display = 'none'; modalStepFinal.classList.remove('active');
                 successModalOverlay.classList.add('visible');
                 console.log("Overlay class 'visible' added.");
                 setTimeout(() => displayModalStep(currentStepIndex), 50);
             }
             function hideSuccessModal() {
                 console.log("hideSuccessModal called");
                 if(!successModalOverlay) return;
                 successModalOverlay.classList.remove('visible');
                 setTimeout(() => {
                    signInForm?.reset();
                    if (submitButton) {
                        submitButton.disabled = false; submitButton.classList.remove('loading');
                        const textSpan = submitButton.querySelector('.button-text');
                        if (textSpan) { textSpan.textContent = "Request My Compendium"; }
                        else if (!submitButton.querySelector('.button-text')) { submitButton.innerHTML = '<span class="button-text">Request My Compendium</span><div class="spinner"></div>'; }
                    }
                    if(modalStepsContainer) modalStepsContainer.innerHTML = '';
                    if(modalStepFinal) { modalStepFinal.style.display = 'none'; modalStepFinal.classList.remove('active'); }
                 }, 400);
             }

            // --- Event Listeners for Modal ---
             if (modalCloseBtn) { modalCloseBtn.addEventListener('click', hideSuccessModal); }
             if (successModalOverlay) { successModalOverlay.addEventListener('click', (event) => { if (event.target === successModalOverlay) { hideSuccessModal(); } }); }
             document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && successModalOverlay?.classList.contains('visible')) { hideSuccessModal(); } });

            // --- Sign In Form Submission Logic ---
            if (signInForm && submitButton) {
                signInForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    submitButton.disabled = true; submitButton.classList.add('loading');
                    initialFormData = { fullName: document.getElementById('fullName').value, email: document.getElementById('email').value, phone: document.getElementById('phone').value, propertyAddress: `${config.property.streetAddress}, ${config.property.cityStateZip}`, submittedAt: new Date().toISOString() };

                    let webhookProcessed = false;
                    if (config.settings.webhookUrl) {
                        console.log(`Sending initial data to webhook: ${config.settings.webhookUrl}`);
                        try { const response = await fetch(config.settings.webhookUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(initialFormData), mode: 'cors' }); if (!response.ok) { console.warn('Webhook failure:', response.status, await response.text()); } else { console.log('Webhook success!'); } }
                        catch (error) { console.error('Webhook error:', error); }
                        finally { webhookProcessed = true; }
                    } else { console.log("No webhook URL. Skipping."); await new Promise(resolve => setTimeout(resolve, 300)); webhookProcessed = true; }

                    if (webhookProcessed) { console.log("Webhook processing complete. Calling showQuestionnaireModal."); showQuestionnaireModal(); }
                    else { console.error("Webhook processing flag not set. Resetting button."); submitButton.disabled = false; submitButton.classList.remove('loading'); }
                });
             } else { console.error("Sign in form or submit button not found!"); }

        }); // End DOMContentLoaded
    </script>

</body>
</html>